# High spatial resolution remote sensing image building extraction method based on-U-Net5C
# 基于U-Net5C的高分辨率遥感影像建筑物提取方法
# A variant model based on the U-Net network

## 1 引言
&nbsp;&nbsp;&nbsp;&nbsp;近年来，高空间分辨率遥感技术发展迅猛，其在民生、军事等领域具有广阔且重要的应用价值。建筑物是人类生活和工作的主要场所，也是最基本的地物类型之一。如今社会发展日新月异，城市更新、土地管理、军事探测以及应急救灾等领域需要相关规划以及执行部门能够快速、准确的获得目标区域建筑物的分布现状、更新信息、受灾面积和损毁程度。传统的人工收集信息成本巨大，而基于高分辨率遥感影像的建筑物自动提取技术能够极大的减小该项工作的成本。受限于遥感影像的数据质量和分析方法，早期的建筑物提取任务中大多直接使用已有直观的自然图像分割方法，提取效果较差。相比于早期的图像分割方法，基于传统机器学习的遥感影像建筑物自动提取方法能够根据遥感影像中各像元已有的灰度值及其像元边界等浅层特征用以判别遥感影像中建筑物与非建筑物类型，提取效果相较以前有了较大提升，但因其对深层次的各像素之间相互影响因素以及位置信息更不敏感，再加上建筑物本身外型结构的日益复杂（如建筑物尺寸不一、建筑物边界千姿百态以及在遥感影像中的建筑物通常伴随着阴影），这就导致了基于传统机器学习的高分辨率遥感影像建筑物提取方法适用性低下，处理效率不高。近十年来，伴随着深度学习的发展，各种深度卷积神经网络结构层出不穷，在众多模型之中，有学者研究认为U-NET凭借其规则的网络结构，客观的语义分割结果，其是遥感影像建筑物自动提取领域的首选网络。然而，本研究在使用WHU Bilding Dataset进行试验的过程中，发现了U-Net在遥感影像建筑物提取的应用中，存在三个主要问题：1.在模型训练过程中，由于最终下采样倍数相对于小面积建筑物来说较大，导致面积小的建筑物特征容易丢失；2.对于面积较大的建筑物或建筑物群而言存在预测时其内部出现空洞现象，分割结果有待提升；3.由于误分所导致的噪点较多问题，此外建筑物提取边界不够平滑规整，存在预测边界“扩张”现象。  
![image](https://github.com/user-attachments/assets/61d4c622-9e42-4626-bb8a-c3bbe1dc7d75)
&nbsp;&nbsp;![image](https://github.com/user-attachments/assets/bee2a321-441f-4bd2-90c9-e5e930c55406)  

## 2 研究方法
![image](https://github.com/user-attachments/assets/aa7a3637-6eaf-4478-bf42-8a94ce15e45d)
&nbsp;&nbsp;&nbsp;&nbsp;针对上述不足，本研究充分考虑U-Net模型中各输入、输出层的常宽度以及所采用数据集中各建筑物的像元尺寸，根据有限的硬件设施对U-Net模型进行应用优化：①在编码器始端与解码器末端额外添加1次空间连接，使得遥感影像各尺寸建筑物特征进一步保留，缓解小面积建筑物漏提现象；②将原U-Net中用于上采样处理的转置卷积(Transpose Convolution)替换为双线性插值(Bilinear Interpolat-ion)，相比于转置卷积，双线性插值所需的训练参数更少，所需训练时常更短，其上采样原理可能将在一定程度上缓解大面积建筑物内部空洞的缺陷；③为使网络收敛更加充分，建筑物提取边界更加平滑规整，在每次卷积运算过后对其进行批量归一化处理，将经批量归一化(Batch Normalization, BN)处理后的输出再输入进激活函数当中，此外使用LeakyReLU激活函数替代ReLU激活函数以缓解“梯度消失”问题。  
![image](https://github.com/user-attachments/assets/e9587e1b-7d8a-4d1d-b196-685bc23b660a)  

## 3 实验结果与分析
### 3.1 实验结果
&nbsp;&nbsp;&nbsp;&nbsp;本研究采用控制变量实验法并使用3.2节所选数据集讨论双线性插值上采样法是否能够提升U-Net5C训练速度，实验结果表明，采用双线性插值上采样法可以明显加快模型训练速度，各模型训练时常如表3所示，其中U-Net5C(-BN)代表未采用批量归一化处理的U-Net5C模型，U-Net5C(-BI)代表未使用双线性插值（即采用转置卷积）的U-Net5C模型，各测试模型Epoch均设置为100轮。此外，本研究以Dice系数作为模型训练过程中的主要精度评定指标，实验结果如图8所示，结果表明添加BN层能够使得U-Net5C网络收敛更加迅速，训练效果更加充分。  
![image](https://github.com/user-attachments/assets/4b509256-cbcd-41d2-b362-2c0e458ddcf1)  
![image](https://github.com/user-attachments/assets/d4525e66-136c-4256-b8d4-c20e199e5c51)  
![image](https://github.com/user-attachments/assets/de368906-7aa6-4503-a44f-c6724bbe397e)  

### 3.2 实验分析
&nbsp;&nbsp;&nbsp;&nbsp;图5分别代表遥感影像、GT标签、原U-Net模型和U-Net5C的预测结果。如图5绿色框所示，原U-Net模型在遥感影像建筑物提取任务中大型建筑物内部空洞现象和误分现象明显；使用U-Net5C模型进行遥感建筑物提取能够使大型建筑物内部空洞问题得到有效缓解，大型建筑物内部像素点连续性明显加强，这是因为双线性插值致使两个相邻的建筑物特征点之间经上采样后所得预测结果更有可能是建筑物；由于BN层以及LeakyReLU激活函数的加入，使得U-Net5C网络收敛的更加充分，噪点产生和误分现象显著减少。  
![image](https://github.com/user-attachments/assets/928bebd8-4ef8-4008-9943-862942a56549)  
&nbsp;&nbsp;&nbsp;&nbsp;如图6所示，U-Net5C能够较为出色的完成中型建筑物提取任务，这在第一和第三列图块中犹为明显。如图6绿色框所示，相比于原U-Net模型，U-Net5C所提取的中型建筑物边界更加平滑规整，同时更不易受到中型建筑物周围的背景噪点干扰，中型建筑物边界细节保留更加充分，其原因在于U-Net5C额外添加的卷积层和“浅层空间连接”能够有效的提取、保留和传输建筑物“初级特征”和“细节特征”。此外，如图6橙色框所示，小部分中型建筑物边界提取结果与真实标签仍有些许差距，表明本研究能够有效缓解但不能完全解决建筑物提取边界不够平滑规整的问题。  
![image](https://github.com/user-attachments/assets/ed4fb96a-e614-42c0-9a9c-e78439200d8f)  
&nbsp;&nbsp;&nbsp;&nbsp;由于U-Net5C能够进一步提取、保留和传输建筑物“初级特征”和“细节特征”，相比于原U-Net模型，U-Net5C所得预测图效果明显提升，主要表现为预测误分现象减少，小型建筑物漏提现象得到一定程度上的缓解（图7绿色框）。表明在小型建筑物提取任务中，U-Net5C具备更强的适用性，预测结果更为理想。此外，结合图7橙色框所示，U-Net5C存在小部分小型建筑物提取不完整或漏提现象，中小型建筑物边界提取仍有优化空间。  
![image](https://github.com/user-attachments/assets/0c7567e4-13d6-4bdd-b622-291268b7633b)  

## 4 结论
&nbsp;&nbsp;&nbsp;&nbsp;为解决原U-Net模型在高分辨率遥感影像建筑物提取任务中所存在的小型建筑物漏提、中小型建筑物边界不平滑规整、大型建筑物内部空洞等问题，本研究充分利用空间连接机制，在原U-Net模型的基础上扩展5个卷积层并增加1次空间连接，提出了U-Net5C模型。此外U-Net5C模型使用双线性插值法作为上采样方式，并在卷积过程中添加BN层用于加快训练速度，使得网络收敛更加充分。本研究使用WHU Building Dateset测试集对原模型和改进模型进行对比分析，实验证明，相比于原U-Net模型，基于U-Net5C模型的高分辨率遥感影像建筑物提取效果提升显著，各项指标均有提升。主要结论如下：  
&nbsp;（1）在模型首尾两端增设卷积层同时增加空间连接次数，可以进一步保留建筑物“初级特征”和“细节特征”，使得原U-Net模型中关于小型建筑物提取不完整或漏提的缺陷得到明显改善，中小型建筑物边界更加平滑规整。  
&nbsp;（2）在各卷积层中设置BN层与LeakyReLU激活函数能够有效克服深度学习过程中的梯度“消失”现象，加快模型收敛并使得收敛更加充分，图像噪点明显减少；上采样过程用双线性插值替代转置卷积可以有效减少网络训练所需时间，缓解同一建筑物目标内的空洞现象。相比于原U-Net模型，U-Net5C模型Dice系数提升3.9%，准确率提升1.3%、召回率提升1.5%、F1分数提升1.3%、前景交并比提升2.3%，平均交并比提升1.4%。
